(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8967],{5649:(e,t,s)=>{Promise.resolve().then(s.bind(s,5098))},7401:(e,t,s)=>{"use strict";s.d(t,{A:()=>x});var a=s(2115);let r=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),l=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,s)=>s?s.toUpperCase():t.toLowerCase()),n=e=>{let t=l(e);return t.charAt(0).toUpperCase()+t.slice(1)},c=function(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return t.filter((e,t,s)=>!!e&&""!==e.trim()&&s.indexOf(e)===t).join(" ").trim()},i=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};var d={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let o=(0,a.forwardRef)((e,t)=>{let{color:s="currentColor",size:r=24,strokeWidth:l=2,absoluteStrokeWidth:n,className:o="",children:x,iconNode:m,...h}=e;return(0,a.createElement)("svg",{ref:t,...d,width:r,height:r,stroke:s,strokeWidth:n?24*Number(l)/Number(r):l,className:c("lucide",o),...!x&&!i(h)&&{"aria-hidden":"true"},...h},[...m.map(e=>{let[t,s]=e;return(0,a.createElement)(t,s)}),...Array.isArray(x)?x:[x]])}),x=(e,t)=>{let s=(0,a.forwardRef)((s,l)=>{let{className:i,...d}=s;return(0,a.createElement)(o,{ref:l,iconNode:t,className:c("lucide-".concat(r(n(e))),"lucide-".concat(e),i),...d})});return s.displayName=n(e),s}},3518:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(7401).A)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},6967:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(7401).A)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},1594:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(7401).A)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},3239:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(7401).A)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},5340:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(7401).A)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},6889:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(7401).A)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]])},4857:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(7401).A)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]])},2598:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(7401).A)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},3466:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(7401).A)("file-check",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]])},4081:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(7401).A)("file-text",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},4505:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(7401).A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},1773:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(7401).A)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},853:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(7401).A)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])},8283:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(7401).A)("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]])},6046:(e,t,s)=>{"use strict";var a=s(6658);s.o(a,"useParams")&&s.d(t,{useParams:function(){return a.useParams}}),s.o(a,"usePathname")&&s.d(t,{usePathname:function(){return a.usePathname}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}}),s.o(a,"useSearchParams")&&s.d(t,{useSearchParams:function(){return a.useSearchParams}})},5098:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>T});var a=s(5155),r=s(2115),l=s(6046),n=s(8173),c=s.n(n),i=s(6889),d=s(3466),o=s(3239),x=s(5340),m=s(1594),h=s(7401);let u=(0,h.A)("house",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]]);var p=s(1773),g=s(853);let j=(0,h.A)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]);var y=s(4505),b=s(2598),N=s(4857),f=s(4081);let v=(0,h.A)("pen-line",[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);var w=s(8283),A=s(3518),k=s(6967);let E=e=>new Date(e).toLocaleDateString("es-PE",{day:"2-digit",month:"2-digit",year:"numeric"}),C=e=>new Date(e).toLocaleString("es-PE",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),R=e=>{let t="string"==typeof e?parseFloat(e):e;return"S/ ".concat(t.toFixed(2))},S=e=>{let{status:t}=e,s={DRAFT:{bg:"bg-gray-100",text:"text-gray-600",icon:(0,a.jsx)(i.A,{className:"w-3 h-3"})},SIGNED:{bg:"bg-blue-100",text:"text-blue-600",icon:(0,a.jsx)(d.A,{className:"w-3 h-3"})},SENT:{bg:"bg-yellow-100",text:"text-yellow-600",icon:(0,a.jsx)(i.A,{className:"w-3 h-3"})},ACCEPTED:{bg:"bg-green-100",text:"text-green-600",icon:(0,a.jsx)(o.A,{className:"w-3 h-3"})},REJECTED:{bg:"bg-red-100",text:"text-red-600",icon:(0,a.jsx)(x.A,{className:"w-3 h-3"})},OBSERVED:{bg:"bg-orange-100",text:"text-orange-600",icon:(0,a.jsx)(m.A,{className:"w-3 h-3"})},ERROR:{bg:"bg-red-100",text:"text-red-600",icon:(0,a.jsx)(x.A,{className:"w-3 h-3"})},CANCELED:{bg:"bg-gray-100",text:"text-gray-500",icon:(0,a.jsx)(x.A,{className:"w-3 h-3"})}},r=s[t]||s.DRAFT;return(0,a.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ".concat(r.bg," ").concat(r.text),children:[r.icon,t]})},D=e=>{let{type:t}=e;return(0,a.jsx)("span",{className:"px-2 py-0.5 rounded text-xs font-medium ".concat({FACTURA:"bg-indigo-100 text-indigo-700",BOLETA:"bg-purple-100 text-purple-700",NC:"bg-amber-100 text-amber-700",ND:"bg-pink-100 text-pink-700",SUMMARY:"bg-cyan-100 text-cyan-700",VOIDED:"bg-gray-100 text-gray-700"}[t]||"bg-gray-100 text-gray-600"),children:{FACTURA:"Factura",BOLETA:"Boleta",NC:"Nota Cr\xe9dito",ND:"Nota D\xe9bito",SUMMARY:"Resumen",VOIDED:"Baja"}[t]||t})};function T(){(0,l.useRouter)();let[e,t]=(0,r.useState)(!0),[s,n]=(0,r.useState)(null),[d,h]=(0,r.useState)(null),[T,L]=(0,r.useState)(""),[M,P]=(0,r.useState)(""),[O,z]=(0,r.useState)("ALL"),[U,F]=(0,r.useState)("ALL"),[B,V]=(0,r.useState)(""),[I,q]=(0,r.useState)(1),[H,J]=(0,r.useState)(!1),[_,G]=(0,r.useState)(null),[X,W]=(0,r.useState)(null),[Y,Z]=(0,r.useState)(null),[$,K]=(0,r.useState)(null),[Q,ee]=(0,r.useState)(null),et=(0,r.useCallback)(async()=>{t(!0),n(null);try{let e=new URLSearchParams;T&&e.set("from",T),M&&e.set("to",M),"ALL"!==O&&e.set("type",O),"ALL"!==U&&e.set("status",U),B.trim()&&e.set("q",B.trim()),e.set("page",String(I)),e.set("pageSize","25");let t=await fetch("/api/sunat/documents?".concat(e.toString()));if(!t.ok){let e=await t.json();throw Error(e.error||"Error al cargar documentos")}let s=await t.json();h(s)}catch(e){n(e.message)}finally{t(!1)}},[T,M,O,U,B,I]);(0,r.useEffect)(()=>{et()},[et]);let es=async(e,t)=>{G("".concat(e,"-").concat(t));try{let s=await fetch("/api/sunat/documents/".concat(e,"/download?type=").concat(t));if(!s.ok){let e=await s.json();throw Error(e.error||"Error al descargar")}let a=await s.blob(),r=window.URL.createObjectURL(a),l=document.createElement("a");l.href=r;let n=s.headers.get("content-disposition"),c="xml"===t?"documento.xml":"cdr.xml";if(n){let e=n.match(/filename="(.+)"/);e&&(c=e[1])}l.download=c,document.body.appendChild(l),l.click(),l.remove(),window.URL.revokeObjectURL(r)}catch(e){alert(e.message)}finally{G(null)}},ea=async e=>{if(confirm("\xbfEnviar este documento a SUNAT?")){Z(e);try{let t=await fetch("/api/sunat/documents/".concat(e,"/queue"),{method:"POST"});if(!t.ok){let e=await t.json();throw Error(e.error||"Error al encolar")}alert("Documento encolado para env\xedo a SUNAT. El worker lo procesar\xe1 en segundos."),et()}catch(e){alert(e.message)}finally{Z(null)}}},er=async e=>{K(e);try{let t=await fetch("/api/sunat/documents/".concat(e,"/sign"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({force:!1})});if(!t.ok){let e=await t.json();throw Error(e.error||"Error al firmar")}alert("Documento firmado correctamente. Ahora puedes enviarlo a SUNAT."),et()}catch(e){alert(e.message)}finally{K(null)}},el=async e=>{if(confirm("\xbfReintentar env\xedo de este documento a SUNAT?")){W(e);try{let t=await fetch("/api/sunat/documents/".concat(e,"/retry"),{method:"POST"});if(!t.ok){let e=await t.json();throw Error(e.error||"Error al reintentar")}alert("Documento encolado para reintento"),et()}catch(e){alert(e.message)}finally{W(null)}}},en=d?{accepted:d.items.filter(e=>"ACCEPTED"===e.status).length,pending:d.items.filter(e=>["SIGNED","SENT","DRAFT"].includes(e.status)).length,errors:d.items.filter(e=>["ERROR","REJECTED"].includes(e.status)).length}:{accepted:0,pending:0,errors:0};return(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50 p-4 md:p-6",children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-500 mb-2",children:[(0,a.jsxs)(c(),{href:"/",className:"hover:text-blue-600 flex items-center gap-1",children:[(0,a.jsx)(u,{className:"w-4 h-4"}),"Inicio"]}),(0,a.jsx)("span",{children:"/"}),(0,a.jsx)("span",{className:"text-gray-900",children:"Documentos Electr\xf3nicos"})]}),(0,a.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Documentos Electr\xf3nicos SUNAT"}),(0,a.jsx)("p",{className:"text-gray-600 mt-1",children:"Facturas, boletas y documentos electr\xf3nicos emitidos"})]}),(0,a.jsxs)("button",{onClick:et,disabled:e,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:[(0,a.jsx)(p.A,{className:"w-4 h-4 ".concat(e?"animate-spin":"")}),"Actualizar"]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[(0,a.jsxs)("div",{className:"bg-white rounded-lg p-4 border border-green-200",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(o.A,{className:"w-5 h-5 text-green-600"}),(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"Aceptados"})]}),(0,a.jsx)("div",{className:"text-2xl font-bold text-green-600 mt-1",children:en.accepted})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg p-4 border border-yellow-200",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(i.A,{className:"w-5 h-5 text-yellow-600"}),(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"Pendientes"})]}),(0,a.jsx)("div",{className:"text-2xl font-bold text-yellow-600 mt-1",children:en.pending})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg p-4 border border-red-200",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(x.A,{className:"w-5 h-5 text-red-600"}),(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"Errores"})]}),(0,a.jsx)("div",{className:"text-2xl font-bold text-red-600 mt-1",children:en.errors})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border p-4 mb-6",children:[(0,a.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,a.jsxs)("div",{className:"flex-1 relative",children:[(0,a.jsx)(g.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),(0,a.jsx)("input",{type:"text",placeholder:"Buscar por n\xfamero, cliente...",value:B,onChange:e=>{V(e.target.value),q(1)},className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),(0,a.jsxs)("button",{onClick:()=>J(!H),className:"flex items-center gap-2 px-4 py-2 border rounded-lg ".concat(H?"bg-blue-50 border-blue-300":""),children:[(0,a.jsx)(j,{className:"w-4 h-4"}),"Filtros"]})]}),H&&(0,a.jsxs)("div",{className:"mt-4 pt-4 border-t grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Desde"}),(0,a.jsx)("input",{type:"date",value:T,onChange:e=>{L(e.target.value),q(1)},className:"w-full px-3 py-2 border rounded-lg text-sm"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Hasta"}),(0,a.jsx)("input",{type:"date",value:M,onChange:e=>{P(e.target.value),q(1)},className:"w-full px-3 py-2 border rounded-lg text-sm"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipo"}),(0,a.jsxs)("select",{value:O,onChange:e=>{z(e.target.value),q(1)},className:"w-full px-3 py-2 border rounded-lg text-sm",children:[(0,a.jsx)("option",{value:"ALL",children:"Todos"}),(0,a.jsx)("option",{value:"FACTURA",children:"Factura"}),(0,a.jsx)("option",{value:"BOLETA",children:"Boleta"}),(0,a.jsx)("option",{value:"NC",children:"Nota Cr\xe9dito"}),(0,a.jsx)("option",{value:"ND",children:"Nota D\xe9bito"}),(0,a.jsx)("option",{value:"SUMMARY",children:"Resumen"}),(0,a.jsx)("option",{value:"VOIDED",children:"Baja"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Estado"}),(0,a.jsxs)("select",{value:U,onChange:e=>{F(e.target.value),q(1)},className:"w-full px-3 py-2 border rounded-lg text-sm",children:[(0,a.jsx)("option",{value:"ALL",children:"Todos"}),(0,a.jsx)("option",{value:"ACCEPTED",children:"Aceptado"}),(0,a.jsx)("option",{value:"SIGNED",children:"Firmado"}),(0,a.jsx)("option",{value:"SENT",children:"Enviado"}),(0,a.jsx)("option",{value:"DRAFT",children:"Borrador"}),(0,a.jsx)("option",{value:"ERROR",children:"Error"}),(0,a.jsx)("option",{value:"REJECTED",children:"Rechazado"}),(0,a.jsx)("option",{value:"OBSERVED",children:"Observado"})]})]}),(0,a.jsx)("div",{className:"col-span-2 md:col-span-4 flex justify-end",children:(0,a.jsx)("button",{onClick:()=>{L(""),P(""),z("ALL"),F("ALL"),V(""),q(1)},className:"text-sm text-blue-600 hover:underline",children:"Limpiar filtros"})})]})]}),s&&(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:(0,a.jsxs)("div",{className:"flex items-center gap-2 text-red-600",children:[(0,a.jsx)(m.A,{className:"w-5 h-5"}),(0,a.jsx)("span",{children:s})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm border overflow-hidden",children:e?(0,a.jsxs)("div",{className:"flex items-center justify-center py-12",children:[(0,a.jsx)(y.A,{className:"w-6 h-6 animate-spin text-gray-400"}),(0,a.jsx)("span",{className:"ml-2 text-gray-500",children:"Cargando documentos..."})]}):d&&d.items.length>0?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full text-sm",children:[(0,a.jsx)("thead",{className:"bg-gray-50 border-b",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-4 py-3 text-left font-medium text-gray-600",children:"Fecha"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left font-medium text-gray-600",children:"Tipo"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left font-medium text-gray-600",children:"N\xfamero"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left font-medium text-gray-600",children:"Cliente"}),(0,a.jsx)("th",{className:"px-4 py-3 text-right font-medium text-gray-600",children:"Total"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left font-medium text-gray-600",children:"Estado"}),(0,a.jsx)("th",{className:"px-4 py-3 text-center font-medium text-gray-600",children:"Acciones"})]})}),(0,a.jsx)("tbody",{className:"divide-y",children:d.items.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"px-4 py-3 whitespace-nowrap",children:E(e.issueDate)}),(0,a.jsx)("td",{className:"px-4 py-3",children:(0,a.jsx)(D,{type:e.docType})}),(0,a.jsxs)("td",{className:"px-4 py-3 font-mono text-sm",children:[e.fullNumber,e.saleNumber&&(0,a.jsxs)("span",{className:"text-gray-400 ml-2",children:["(#",e.saleNumber,")"]})]}),(0,a.jsxs)("td",{className:"px-4 py-3",children:[(0,a.jsx)("div",{className:"max-w-[200px] truncate",title:e.customerName,children:e.customerName}),(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:[e.customerDocType,": ",e.customerDocNumber]})]}),(0,a.jsx)("td",{className:"px-4 py-3 text-right font-medium",children:R(e.total)}),(0,a.jsxs)("td",{className:"px-4 py-3",children:[(0,a.jsx)(S,{status:e.status}),e.sunatMessage&&(0,a.jsxs)("div",{className:"text-xs text-gray-500 max-w-[150px] truncate mt-1 cursor-help",title:e.sunatMessage,children:[e.sunatCode?"[".concat(e.sunatCode,"] "):"",e.sunatMessage]})]}),(0,a.jsx)("td",{className:"px-4 py-3",children:(0,a.jsxs)("div",{className:"flex items-center justify-center gap-1",children:[(0,a.jsx)("button",{onClick:()=>ee(e),className:"p-1.5 hover:bg-gray-100 rounded",title:"Ver detalle",children:(0,a.jsx)(b.A,{className:"w-4 h-4 text-gray-600"})}),e.hasXmlSigned&&(0,a.jsx)("button",{onClick:()=>es(e.id,"xml"),disabled:_==="".concat(e.id,"-xml"),className:"p-1.5 hover:bg-blue-50 rounded",title:"Descargar XML",children:_==="".concat(e.id,"-xml")?(0,a.jsx)(y.A,{className:"w-4 h-4 animate-spin text-blue-600"}):(0,a.jsx)(N.A,{className:"w-4 h-4 text-blue-600"})}),e.hasCdr&&(0,a.jsx)("button",{onClick:()=>es(e.id,"cdr"),disabled:_==="".concat(e.id,"-cdr"),className:"p-1.5 hover:bg-green-50 rounded",title:"Descargar CDR",children:_==="".concat(e.id,"-cdr")?(0,a.jsx)(y.A,{className:"w-4 h-4 animate-spin text-green-600"}):(0,a.jsx)(f.A,{className:"w-4 h-4 text-green-600"})}),"DRAFT"===e.status&&(0,a.jsx)("button",{onClick:()=>er(e.id),disabled:$===e.id,className:"p-1.5 hover:bg-amber-50 rounded",title:"Firmar documento",children:$===e.id?(0,a.jsx)(y.A,{className:"w-4 h-4 animate-spin text-amber-600"}):(0,a.jsx)(v,{className:"w-4 h-4 text-amber-600"})}),"SIGNED"===e.status&&(0,a.jsx)("button",{onClick:()=>ea(e.id),disabled:Y===e.id,className:"p-1.5 hover:bg-green-50 rounded",title:"Enviar a SUNAT",children:Y===e.id?(0,a.jsx)(y.A,{className:"w-4 h-4 animate-spin text-green-600"}):(0,a.jsx)(w.A,{className:"w-4 h-4 text-green-600"})}),["ERROR","REJECTED","SENT"].includes(e.status)&&(0,a.jsx)("button",{onClick:()=>el(e.id),disabled:X===e.id,className:"p-1.5 hover:bg-orange-50 rounded",title:"Reintentar env\xedo",children:X===e.id?(0,a.jsx)(y.A,{className:"w-4 h-4 animate-spin text-orange-600"}):(0,a.jsx)(p.A,{className:"w-4 h-4 text-orange-600"})})]})})]},e.id))})]})}),d.totalPages>1&&(0,a.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 border-t bg-gray-50",children:[(0,a.jsxs)("div",{className:"text-sm text-gray-600",children:["Mostrando ",(d.page-1)*d.pageSize+1," - ",Math.min(d.page*d.pageSize,d.total)," de ",d.total]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("button",{onClick:()=>q(e=>Math.max(1,e-1)),disabled:1===I,className:"p-2 border rounded hover:bg-white disabled:opacity-50",children:(0,a.jsx)(A.A,{className:"w-4 h-4"})}),(0,a.jsxs)("span",{className:"text-sm",children:["P\xe1gina ",d.page," de ",d.totalPages]}),(0,a.jsx)("button",{onClick:()=>q(e=>Math.min(d.totalPages,e+1)),disabled:I===d.totalPages,className:"p-2 border rounded hover:bg-white disabled:opacity-50",children:(0,a.jsx)(k.A,{className:"w-4 h-4"})})]})]})]}):(0,a.jsxs)("div",{className:"py-12 text-center",children:[(0,a.jsx)(f.A,{className:"w-12 h-12 mx-auto text-gray-300 mb-3"}),(0,a.jsx)("p",{className:"text-gray-500",children:"No hay documentos electr\xf3nicos"}),(0,a.jsx)("p",{className:"text-sm text-gray-400 mt-1",children:"Los documentos aparecer\xe1n aqu\xed cuando se emitan facturas o boletas"})]})}),Q&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-xl max-w-lg w-full max-h-[80vh] overflow-y-auto",children:[(0,a.jsx)("div",{className:"p-6 border-b",children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(D,{type:Q.docType}),(0,a.jsx)("h2",{className:"text-xl font-bold mt-2",children:Q.fullNumber})]}),(0,a.jsx)("button",{onClick:()=>ee(null),className:"text-gray-400 hover:text-gray-600",children:"âœ•"})]})}),(0,a.jsxs)("div",{className:"p-6 space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Estado"}),(0,a.jsx)(S,{status:Q.status})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Fecha emisi\xf3n"}),(0,a.jsx)("span",{className:"font-medium",children:C(Q.issueDate)})]}),(0,a.jsxs)("div",{className:"pt-2 border-t",children:[(0,a.jsx)("span",{className:"text-sm text-gray-500",children:"Cliente"}),(0,a.jsx)("div",{className:"font-medium",children:Q.customerName}),(0,a.jsxs)("div",{className:"text-sm text-gray-600",children:[Q.customerDocType,": ",Q.customerDocNumber]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between pt-2 border-t",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Total"}),(0,a.jsx)("span",{className:"text-xl font-bold",children:R(Q.total)})]}),Q.sunatMessage&&(0,a.jsxs)("div",{className:"pt-2 border-t",children:[(0,a.jsx)("span",{className:"text-sm text-gray-500",children:"Respuesta SUNAT"}),(0,a.jsxs)("div",{className:"text-sm mt-1 p-2 rounded ".concat("ACCEPTED"===Q.status?"bg-green-50 text-green-700":"REJECTED"===Q.status||"ERROR"===Q.status?"bg-red-50 text-red-700":"bg-gray-50 text-gray-700"),children:[Q.sunatCode&&(0,a.jsxs)("span",{className:"font-mono",children:["[",Q.sunatCode,"] "]}),Q.sunatMessage]})]}),Q.saleNumber&&(0,a.jsxs)("div",{className:"flex items-center justify-between pt-2 border-t",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Venta"}),(0,a.jsxs)(c(),{href:"/receipt/".concat(Q.saleId),className:"text-blue-600 hover:underline",children:["#",Q.saleNumber]})]})]}),(0,a.jsxs)("div",{className:"p-6 border-t bg-gray-50 flex gap-3",children:[Q.hasXmlSigned&&(0,a.jsxs)("button",{onClick:()=>es(Q.id,"xml"),disabled:_==="".concat(Q.id,"-xml"),className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[(0,a.jsx)(N.A,{className:"w-4 h-4"}),"XML"]}),Q.hasCdr&&(0,a.jsxs)("button",{onClick:()=>es(Q.id,"cdr"),disabled:_==="".concat(Q.id,"-cdr"),className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:[(0,a.jsx)(f.A,{className:"w-4 h-4"}),"CDR"]}),["ERROR","REJECTED","SENT"].includes(Q.status)&&(0,a.jsxs)("button",{onClick:()=>{el(Q.id),ee(null)},disabled:X===Q.id,className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700",children:[(0,a.jsx)(p.A,{className:"w-4 h-4"}),"Reintentar"]})]})]})})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[8173,8441,1517,7358],()=>t(5649)),_N_E=e.O()}]);