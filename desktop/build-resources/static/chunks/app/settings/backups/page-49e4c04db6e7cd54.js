(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3946],{1760:(e,s,a)=>{Promise.resolve().then(a.bind(a,8751))},7401:(e,s,a)=>{"use strict";a.d(s,{A:()=>m});var r=a(2115);let t=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),l=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,s,a)=>a?a.toUpperCase():s.toLowerCase()),i=e=>{let s=l(e);return s.charAt(0).toUpperCase()+s.slice(1)},n=function(){for(var e=arguments.length,s=Array(e),a=0;a<e;a++)s[a]=arguments[a];return s.filter((e,s,a)=>!!e&&""!==e.trim()&&a.indexOf(e)===s).join(" ").trim()},d=e=>{for(let s in e)if(s.startsWith("aria-")||"role"===s||"title"===s)return!0};var c={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let o=(0,r.forwardRef)((e,s)=>{let{color:a="currentColor",size:t=24,strokeWidth:l=2,absoluteStrokeWidth:i,className:o="",children:m,iconNode:x,...u}=e;return(0,r.createElement)("svg",{ref:s,...c,width:t,height:t,stroke:a,strokeWidth:i?24*Number(l)/Number(t):l,className:n("lucide",o),...!m&&!d(u)&&{"aria-hidden":"true"},...u},[...x.map(e=>{let[s,a]=e;return(0,r.createElement)(s,a)}),...Array.isArray(m)?m:[m]])}),m=(e,s)=>{let a=(0,r.forwardRef)((a,l)=>{let{className:d,...c}=a;return(0,r.createElement)(o,{ref:l,iconNode:s,className:n("lucide-".concat(t(i(e))),"lucide-".concat(e),d),...c})});return a.displayName=i(e),a}},6336:(e,s,a)=>{"use strict";a.d(s,{A:()=>r});let r=(0,a(7401).A)("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]])},4857:(e,s,a)=>{"use strict";a.d(s,{A:()=>r});let r=(0,a(7401).A)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]])},3950:(e,s,a)=>{"use strict";a.d(s,{A:()=>r});let r=(0,a(7401).A)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},8684:(e,s,a)=>{"use strict";a.d(s,{A:()=>r});let r=(0,a(7401).A)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]])},8751:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>o});var r=a(5155),t=a(2115),l=a(814),i=a(4857),n=a(8684),d=a(3950),c=a(6336);function o(){let[e,s]=(0,t.useState)(!1),[a,o]=(0,t.useState)(!1),[m,x]=(0,t.useState)(!1),[u,h]=(0,t.useState)(null),[p,b]=(0,t.useState)(null);async function g(){try{let e=await fetch("/api/auth/is-superadmin");if(e.ok){let s=await e.json();o(s.isSuperAdmin)}}catch(e){console.error("Error checking superadmin:",e)}}(0,t.useEffect)(()=>{g()},[]);let j=async()=>{try{s(!0),l.oR.info("Generando backup...");let e=await fetch("/api/backups/export");if(!e.ok){let s=await e.json();throw Error(s.message||"Error al exportar")}let a=await e.blob(),r=window.URL.createObjectURL(a),t=document.createElement("a");t.href=r;let i=e.headers.get("Content-Disposition"),n=null==i?void 0:i.match(/filename="(.+)"/),d=n?n[1]:"backup_".concat(new Date().toISOString().split("T")[0],".zip");t.download=d,document.body.appendChild(t),t.click(),window.URL.revokeObjectURL(r),document.body.removeChild(t),l.oR.success("Backup descargado exitosamente")}catch(e){console.error("Error exporting backup:",e),l.oR.error(e.message||"Error al exportar backup")}finally{s(!1)}};return(0,r.jsxs)("div",{className:"p-8 max-w-4xl mx-auto",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold mb-2",children:"Backups y Restauraci\xf3n"}),(0,r.jsx)("p",{className:"text-gray-600 mb-8",children:"Gestiona copias de seguridad de tu tienda"}),(0,r.jsx)("div",{className:"bg-white border border-gray-200 rounded-lg p-6 mb-6",children:(0,r.jsxs)("div",{className:"flex items-start gap-4 mb-4",children:[(0,r.jsx)(i.A,{className:"w-6 h-6 text-blue-600 mt-1"}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Descargar Backup"}),(0,r.jsx)("p",{className:"text-gray-600 mb-4",children:"Exporta todos los datos de tu tienda en un archivo ZIP seguro."}),(0,r.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:[(0,r.jsx)("h3",{className:"font-medium text-blue-900 mb-2",children:"\xbfQu\xe9 incluye el backup?"}),(0,r.jsxs)("ul",{className:"text-sm text-blue-800 space-y-1",children:[(0,r.jsx)("li",{children:"✓ Inventario (productos y stock)"}),(0,r.jsx)("li",{children:"✓ Historial de ventas y tickets"}),(0,r.jsx)("li",{children:"✓ Turnos y caja"}),(0,r.jsx)("li",{children:"✓ Clientes y cuentas por cobrar"}),(0,r.jsx)("li",{children:"✓ Movimientos de inventario"}),(0,r.jsx)("li",{children:"✓ Configuraci\xf3n de la tienda"})]})]}),(0,r.jsxs)("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4 mb-4",children:[(0,r.jsx)("h3",{className:"font-medium text-orange-900 mb-2",children:"Seguridad"}),(0,r.jsxs)("ul",{className:"text-sm text-orange-800 space-y-1",children:[(0,r.jsx)("li",{children:"• Las contrase\xf1as NO se exportan"}),(0,r.jsx)("li",{children:"• El archivo contiene solo datos de tu tienda"}),(0,r.jsx)("li",{children:"• Guarda el backup en un lugar seguro"})]})]}),(0,r.jsxs)("button",{onClick:j,disabled:e,className:"flex items-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed font-medium",children:[(0,r.jsx)(i.A,{className:"w-5 h-5"}),e?"Generando backup...":"Exportar Backup (ZIP)"]})]})]})}),a?(0,r.jsx)("div",{className:"bg-white border border-gray-200 rounded-lg p-6 mb-6",children:(0,r.jsxs)("div",{className:"flex items-start gap-4 mb-4",children:[(0,r.jsx)(n.A,{className:"w-6 h-6 text-purple-600 mt-1"}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Restaurar Backup (SUPERADMIN)"}),(0,r.jsx)("p",{className:"text-gray-600 mb-4",children:"Crea una nueva tienda desde un archivo de backup."}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Seleccionar archivo de backup (.zip)"}),(0,r.jsx)("input",{type:"file",accept:".zip",onChange:e=>{var s;let a=null===(s=e.target.files)||void 0===s?void 0:s[0];if(a){if(!a.name.endsWith(".zip")){l.oR.error("Solo se permiten archivos .zip");return}h(a),b(null)}},disabled:m,className:"block w-full text-sm text-gray-500   file:mr-4 file:py-2 file:px-4   file:rounded-md file:border-0   file:text-sm file:font-semibold   file:bg-purple-50 file:text-purple-700   hover:file:bg-purple-100   disabled:opacity-50 disabled:cursor-not-allowed"}),u&&(0,r.jsxs)("p",{className:"mt-2 text-sm text-gray-600",children:["Archivo seleccionado: ",(0,r.jsx)("span",{className:"font-medium",children:u.name})]})]}),(0,r.jsxs)("button",{onClick:async()=>{if(!u){l.oR.error("Selecciona un archivo de backup");return}x(!0),l.oR.info("Restaurando backup...");try{let e=new FormData;e.append("backup",u);let s=await fetch("/api/backups/restore/new-store",{method:"POST",body:e}),a=await s.json();if(!s.ok){l.oR.error(a.message||"Error al restaurar backup");return}b(a),l.oR.success("Backup restaurado exitosamente"),h(null)}catch(e){console.error(e),l.oR.error("Error al restaurar backup")}finally{x(!1)}},disabled:!u||m,className:"w-full bg-purple-600 text-white py-3 px-4 rounded-lg font-semibold   hover:bg-purple-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed   flex items-center justify-center gap-2",children:[(0,r.jsx)(n.A,{className:"w-5 h-5"}),m?"Restaurando...":"Restaurar como Nueva Tienda"]}),(0,r.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(d.A,{className:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5"}),(0,r.jsxs)("div",{className:"text-sm text-blue-800",children:[(0,r.jsx)("p",{className:"font-semibold mb-1",children:"Qu\xe9 hace esta operaci\xf3n:"}),(0,r.jsxs)("ul",{className:"list-disc list-inside space-y-1",children:[(0,r.jsx)("li",{children:"Crea una nueva tienda con los datos del backup"}),(0,r.jsx)("li",{children:"Genera un OWNER con contrase\xf1a temporal"}),(0,r.jsx)("li",{children:"Preserva todo el historial (ventas, turnos, cuentas)"}),(0,r.jsx)("li",{children:"NO afecta ninguna tienda existente"})]})]})]})}),(0,r.jsx)("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4",children:(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(d.A,{className:"w-5 h-5 text-orange-600 flex-shrink-0 mt-0.5"}),(0,r.jsxs)("div",{className:"text-sm text-orange-800",children:[(0,r.jsx)("p",{className:"font-semibold mb-1",children:"Seguridad:"}),(0,r.jsxs)("ul",{className:"list-disc list-inside space-y-1",children:[(0,r.jsx)("li",{children:"Valida integridad con checksum SHA-256"}),(0,r.jsx)("li",{children:"Si el email del OWNER ya existe, genera uno alternativo autom\xe1ticamente"}),(0,r.jsx)("li",{children:"El backup NO contiene contrase\xf1as del sistema original"})]})]})]})})]})]})]})}):(0,r.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-6",children:(0,r.jsxs)("div",{className:"flex items-start gap-4",children:[(0,r.jsx)(d.A,{className:"w-6 h-6 text-yellow-600 mt-1"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-semibold text-yellow-900 mb-2",children:"Restauraci\xf3n de Backups"}),(0,r.jsx)("p",{className:"text-sm text-yellow-800 mb-2",children:"La restauraci\xf3n de backups solo est\xe1 disponible para administradores del sistema."}),(0,r.jsx)("p",{className:"text-sm text-yellow-800",children:"Si necesitas restaurar un backup, contacta al soporte t\xe9cnico."})]})]})}),p&&(0,r.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-6 mt-6",children:[(0,r.jsxs)("div",{className:"flex items-start gap-3 mb-4",children:[(0,r.jsx)(c.A,{className:"w-6 h-6 text-green-600 flex-shrink-0 mt-0.5"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-bold text-green-800",children:"Backup Restaurado Exitosamente"}),(0,r.jsx)("p",{className:"text-sm text-green-700 mt-1",children:p.message})]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg p-4 space-y-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-700",children:"Nueva Tienda:"}),(0,r.jsx)("p",{className:"text-lg font-bold text-gray-900",children:p.store.name}),(0,r.jsxs)("p",{className:"text-xs text-gray-500",children:["ID: ",p.store.id]})]}),(0,r.jsxs)("div",{className:"border-t pt-3",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Credenciales del OWNER:"}),(0,r.jsxs)("div",{className:"bg-gray-50 rounded p-3 space-y-2",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs text-gray-600",children:"Email:"}),(0,r.jsx)("p",{className:"font-mono text-sm font-semibold text-gray-900",children:p.owner.email})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs text-gray-600",children:"Contrase\xf1a Temporal:"}),(0,r.jsx)("p",{className:"font-mono text-sm font-semibold text-red-600",children:p.owner.temporaryPassword})]})]})]}),(0,r.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded p-3",children:[(0,r.jsx)("p",{className:"text-xs font-semibold text-red-800 mb-1",children:"⚠️ IMPORTANTE:"}),(0,r.jsxs)("p",{className:"text-xs text-red-700",children:[p.warning," Esta informaci\xf3n solo se muestra una vez. Gu\xe1rdala en un lugar seguro y entr\xe9gala al due\xf1o de la tienda para que cambie la contrase\xf1a inmediatamente."]})]})]})]})]})}}},e=>{var s=s=>e(e.s=s);e.O(0,[814,8441,1517,7358],()=>s(1760)),_N_E=e.O()}]);