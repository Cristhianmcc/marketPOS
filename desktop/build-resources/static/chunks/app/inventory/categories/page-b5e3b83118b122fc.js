(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3562],{628:(e,a,r)=>{Promise.resolve().then(r.bind(r,8361))},3580:(e,a,r)=>{"use strict";r.d(a,{A:()=>t});let t=(0,r(7401).A)("pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]])},3473:(e,a,r)=>{"use strict";r.d(a,{A:()=>t});let t=(0,r(7401).A)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},7780:(e,a,r)=>{"use strict";r.d(a,{A:()=>t});let t=(0,r(7401).A)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},8361:(e,a,r)=>{"use strict";r.r(a),r.d(a,{default:()=>m});var t=r(5155),s=r(2115),l=r(9445),o=r(3473);let c=(0,r(7401).A)("folder-plus",[["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);var n=r(1719),i=r(6967),d=r(3580),g=r(5686),x=r(767),h=r(7780),u=r(814);function m(){let[e,a]=(0,s.useState)([]),[r,m]=(0,s.useState)(!0),[b,p]=(0,s.useState)(new Set),[y,v]=(0,s.useState)(!1),[j,f]=(0,s.useState)(null),[N,w]=(0,s.useState)(null),[C,k]=(0,s.useState)({name:"",color:"#6b7280"});(0,s.useEffect)(()=>{A()},[]);let A=async()=>{try{m(!0);let e=await fetch("/api/categories?includeInactive=true");if(e.ok){let r=await e.json();a(r.categories||[]);let t=new Set((r.categories||[]).map(e=>e.id));p(t)}}catch(e){console.error("Error loading categories:",e),u.oR.error("Error al cargar categor\xedas")}finally{m(!1)}},E=e=>{p(a=>{let r=new Set(a);return r.has(e)?r.delete(e):r.add(e),r})},z=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;f(null),w(e),k({name:"",color:"#6b7280"}),v(!0)},S=e=>{f(e),w(null),k({name:e.name,color:e.color||"#6b7280"}),v(!0)},M=async e=>{if(e.preventDefault(),!C.name.trim()){u.oR.error("El nombre es requerido");return}try{if(j){let e=await fetch("/api/categories/".concat(j.id),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:C.name.trim(),color:C.color})});if(!e.ok){let a=await e.json();throw Error(a.error||"Error al actualizar")}u.oR.success("Categor\xeda actualizada")}else{let e=await fetch("/api/categories",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:C.name.trim(),color:C.color,parentId:N})});if(!e.ok){let a=await e.json();throw Error(a.error||"Error al crear")}u.oR.success("Categor\xeda creada")}v(!1),A()}catch(e){u.oR.error(e.message)}},R=async e=>{if(confirm('\xbfDesactivar la categor\xeda "'.concat(e.name,'"?')))try{let a=await fetch("/api/categories/".concat(e.id),{method:"DELETE"});if(!a.ok){let e=await a.json();throw Error(e.error||"Error al eliminar")}u.oR.success("Categor\xeda desactivada"),A()}catch(e){u.oR.error(e.message)}},T=async e=>{try{let a=await fetch("/api/categories/".concat(e.id),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({active:!e.active})});if(!a.ok){let e=await a.json();throw Error(e.error||"Error al actualizar")}u.oR.success(e.active?"Categor\xeda desactivada":"Categor\xeda activada"),A()}catch(e){u.oR.error(e.message)}};return(0,t.jsxs)(l.A,{children:[(0,t.jsx)(u.l$,{position:"top-right",richColors:!0}),(0,t.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Gesti\xf3n de Categor\xedas"}),(0,t.jsxs)("p",{className:"text-gray-500 mt-1",children:[e.length," grupos de categor\xedas"]})]}),(0,t.jsxs)("button",{onClick:()=>z(null),className:"flex items-center gap-2 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors",children:[(0,t.jsx)(o.A,{size:20}),"Nueva Categor\xeda"]})]}),r?(0,t.jsx)("div",{className:"flex justify-center py-12",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-600"})}):0===e.length?(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border p-12 text-center",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,t.jsx)(c,{size:32,className:"text-gray-400"})}),(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No hay categor\xedas"}),(0,t.jsx)("p",{className:"text-gray-500 mb-6",children:"Crea tu primera categor\xeda para organizar tus productos"}),(0,t.jsxs)("button",{onClick:()=>z(null),className:"inline-flex items-center gap-2 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700",children:[(0,t.jsx)(o.A,{size:20}),"Crear primera categor\xeda"]})]}):(0,t.jsx)("div",{className:"bg-white rounded-xl shadow-sm border divide-y",children:e.map(e=>(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 p-4 hover:bg-gray-50 ".concat(e.active?"":"opacity-50"),children:[(0,t.jsx)("button",{onClick:()=>E(e.id),className:"p-1 hover:bg-gray-200 rounded",children:e.children&&e.children.length>0?b.has(e.id)?(0,t.jsx)(n.A,{size:20,className:"text-gray-500"}):(0,t.jsx)(i.A,{size:20,className:"text-gray-500"}):(0,t.jsx)("div",{className:"w-5"})}),(0,t.jsx)("div",{className:"w-4 h-4 rounded-full border border-gray-200",style:{backgroundColor:e.color||"#6b7280"}}),(0,t.jsx)("span",{className:"flex-1 font-medium text-gray-900",children:e.name}),e.children&&e.children.length>0&&(0,t.jsxs)("span",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded",children:[e.children.length," subcategor\xedas"]}),(0,t.jsx)("button",{onClick:()=>T(e),className:"text-xs px-2 py-1 rounded ".concat(e.active?"bg-green-100 text-green-700":"bg-gray-100 text-gray-500"),children:e.active?"Activo":"Inactivo"}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)("button",{onClick:()=>z(e.id),className:"p-2 hover:bg-gray-200 rounded text-gray-500 hover:text-green-600",title:"Agregar subcategor\xeda",children:(0,t.jsx)(o.A,{size:18})}),(0,t.jsx)("button",{onClick:()=>S(e),className:"p-2 hover:bg-gray-200 rounded text-gray-500 hover:text-blue-600",title:"Editar",children:(0,t.jsx)(d.A,{size:18})}),(0,t.jsx)("button",{onClick:()=>R(e),className:"p-2 hover:bg-gray-200 rounded text-gray-500 hover:text-red-600",title:"Desactivar",children:(0,t.jsx)(g.A,{size:18})})]})]}),b.has(e.id)&&e.children&&e.children.length>0&&(0,t.jsx)("div",{className:"bg-gray-50 border-t",children:e.children.map(a=>(0,t.jsxs)("div",{className:"flex items-center gap-3 p-3 pl-12 hover:bg-gray-100 border-b last:border-b-0 ".concat(a.active?"":"opacity-50"),children:[(0,t.jsx)("div",{className:"w-3 h-3 rounded-full border border-gray-200",style:{backgroundColor:a.color||e.color||"#6b7280"}}),(0,t.jsx)("span",{className:"flex-1 text-gray-700",children:a.name}),(0,t.jsx)("button",{onClick:()=>T(a),className:"text-xs px-2 py-0.5 rounded ".concat(a.active?"bg-green-100 text-green-700":"bg-gray-200 text-gray-500"),children:a.active?"Activo":"Inactivo"}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)("button",{onClick:()=>S(a),className:"p-1.5 hover:bg-gray-200 rounded text-gray-400 hover:text-blue-600",children:(0,t.jsx)(d.A,{size:16})}),(0,t.jsx)("button",{onClick:()=>R(a),className:"p-1.5 hover:bg-gray-200 rounded text-gray-400 hover:text-red-600",children:(0,t.jsx)(g.A,{size:16})})]})]},a.id))})]},e.id))})]}),y&&(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md mx-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 border-b",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold",children:j?"Editar Categor\xeda":N?"Nueva Subcategor\xeda":"Nueva Categor\xeda"}),(0,t.jsx)("button",{onClick:()=>v(!1),className:"p-1 hover:bg-gray-100 rounded",children:(0,t.jsx)(x.A,{size:20})})]}),(0,t.jsxs)("form",{onSubmit:M,className:"p-4 space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre *"}),(0,t.jsx)("input",{type:"text",value:C.name,onChange:e=>k({...C,name:e.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"Ej: Herramientas Manuales",autoFocus:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Color"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:["#ef4444","#f97316","#f59e0b","#eab308","#84cc16","#22c55e","#10b981","#14b8a6","#06b6d4","#0ea5e9","#3b82f6","#6366f1","#8b5cf6","#a855f7","#d946ef","#ec4899","#f43f5e","#78716c","#6b7280","#64748b"].map(e=>(0,t.jsx)("button",{type:"button",onClick:()=>k({...C,color:e}),className:"w-8 h-8 rounded-full border-2 transition-transform hover:scale-110 ".concat(C.color===e?"border-gray-900 scale-110":"border-transparent"),style:{backgroundColor:e}},e))}),(0,t.jsxs)("div",{className:"mt-2 flex items-center gap-2",children:[(0,t.jsx)("input",{type:"color",value:C.color,onChange:e=>k({...C,color:e.target.value}),className:"w-8 h-8 rounded cursor-pointer"}),(0,t.jsx)("span",{className:"text-sm text-gray-500",children:"Color personalizado"})]})]}),(0,t.jsxs)("div",{className:"flex justify-end gap-3 pt-4",children:[(0,t.jsx)("button",{type:"button",onClick:()=>v(!1),className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Cancelar"}),(0,t.jsxs)("button",{type:"submit",className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:[(0,t.jsx)(h.A,{size:18}),j?"Guardar":"Crear"]})]})]})]})})]})}}},e=>{var a=a=>e(e.s=a);e.O(0,[814,8173,9121,9445,8441,1517,7358],()=>a(628)),_N_E=e.O()}]);