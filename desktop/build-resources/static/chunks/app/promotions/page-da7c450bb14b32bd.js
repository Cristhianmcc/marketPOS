(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8337],{5042:(e,t,a)=>{Promise.resolve().then(a.bind(a,5481))},3473:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(7401).A)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},2118:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(7401).A)("power",[["path",{d:"M12 2v10",key:"mnfbl"}],["path",{d:"M18.4 6.6a9 9 0 1 1-12.77.04",key:"obofu9"}]])},5481:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>m});var r=a(5155),s=a(2115),l=a(9445),o=a(3473);let n=(0,a(7401).A)("power-off",[["path",{d:"M18.36 6.64A9 9 0 0 1 20.77 15",key:"dxknvb"}],["path",{d:"M6.16 6.16a9 9 0 1 0 12.68 12.68",key:"1x7qb5"}],["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);var i=a(2118),c=a(5686),d=a(814),p=a(3666);function m(){let[e,t]=(0,s.useState)([]),[a,m]=(0,s.useState)([]),[u,x]=(0,s.useState)(!0),[h,g]=(0,s.useState)(!1),[y,b]=(0,s.useState)("TWO_FOR_ONE"),[j,v]=(0,s.useState)(""),[N,f]=(0,s.useState)(""),[P,w]=(0,s.useState)("2"),[C,k]=(0,s.useState)(""),[E,S]=(0,s.useState)("18:00"),[A,O]=(0,s.useState)("20:00"),[_,R]=(0,s.useState)(""),[H,T]=(0,s.useState)(""),[F,I]=(0,s.useState)("");(0,s.useEffect)(()=>{D(),M()},[]);let D=async()=>{try{let e=await fetch("/api/promotions"),a=await e.json();t(a.promotions||[])}catch(e){d.oR.error("Error al cargar promociones")}finally{x(!1)}},M=async()=>{try{let e=await fetch("/api/inventory?active=true&limit=1000"),t=await e.json();m(t.products.map(e=>({id:e.product.id,name:e.product.name,content:e.product.content,price:e.price})))}catch(e){console.error("Error loading products:",e)}},q=async e=>{e.preventDefault();try{let e={type:y,name:j,productId:N||null};if(("TWO_FOR_ONE"===y||"PACK_PRICE"===y)&&(e.minQty=parseInt(P)),"PACK_PRICE"===y&&(e.packPrice=parseFloat(C)),"HAPPY_HOUR"===y){let t=new Date().toISOString().split("T")[0];e.happyStart="".concat(t,"T").concat(E,":00"),e.happyEnd="".concat(t,"T").concat(A,":00"),e.happyPrice=parseFloat(_)}H&&(e.startsAt=H),F&&(e.endsAt=F);let t=await fetch("/api/promotions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){let e=await t.json();d.oR.error(e.message);return}d.oR.success("Promoci\xf3n creada"),g(!1),K(),D()}catch(e){d.oR.error("Error al crear promoci\xf3n")}},K=()=>{v(""),f(""),w("2"),k(""),R(""),T(""),I("")},W=async(e,t)=>{try{await fetch("/api/promotions/".concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({active:!t})}),d.oR.success(t?"Promoci\xf3n desactivada":"Promoci\xf3n activada"),D()}catch(e){d.oR.error("Error al actualizar promoci\xf3n")}},L=async e=>{if(confirm("\xbfEliminar esta promoci\xf3n?"))try{await fetch("/api/promotions/".concat(e),{method:"DELETE"}),d.oR.success("Promoci\xf3n eliminada"),D()}catch(e){d.oR.error("Error al eliminar promoci\xf3n")}},U=e=>{switch(e){case"TWO_FOR_ONE":return"2x1";case"PACK_PRICE":return"Pack";case"HAPPY_HOUR":return"Happy Hour";default:return e}};return(0,r.jsxs)(l.A,{children:[(0,r.jsx)(d.l$,{position:"top-right"}),(0,r.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Promociones"}),(0,r.jsxs)("button",{onClick:()=>g(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[(0,r.jsx)(o.A,{className:"w-5 h-5"}),"Nueva Promoci\xf3n"]})]}),u?(0,r.jsx)("div",{className:"text-center py-12",children:"Cargando..."}):(0,r.jsxs)("div",{className:"grid gap-4",children:[e.map(e=>(0,r.jsx)("div",{className:"border rounded-lg p-4 ".concat(e.active?"bg-white border-gray-200":"bg-gray-50 border-gray-300"),children:(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,r.jsx)("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 text-xs font-medium rounded",children:U(e.type)}),e.active?(0,r.jsx)("span",{className:"px-2 py-1 bg-green-100 text-green-700 text-xs font-medium rounded",children:"Activa"}):(0,r.jsx)("span",{className:"px-2 py-1 bg-gray-200 text-gray-700 text-xs font-medium rounded",children:"Inactiva"})]}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:e.name}),e.product&&(0,r.jsxs)("p",{className:"text-sm text-gray-600 mb-2",children:["Producto: ",e.product.name,e.product.content&&" ".concat(e.product.content)]}),(0,r.jsxs)("div",{className:"text-sm text-gray-600 space-y-1",children:["TWO_FOR_ONE"===e.type&&(0,r.jsxs)("p",{children:["• Compra ",e.minQty,", lleva ",Math.floor((e.minQty||0)/2)," gratis"]}),"PACK_PRICE"===e.type&&(0,r.jsxs)("p",{children:["• ",e.minQty," unidades por ",(0,p.up)(e.packPrice||0)]}),"HAPPY_HOUR"===e.type&&e.happyStart&&e.happyEnd&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("p",{children:["• Horario: ",new Date(e.happyStart).toLocaleTimeString("es-PE",{hour:"2-digit",minute:"2-digit"})," - ",new Date(e.happyEnd).toLocaleTimeString("es-PE",{hour:"2-digit",minute:"2-digit"})]}),(0,r.jsxs)("p",{children:["• Precio: ",(0,p.up)(e.happyPrice||0)]})]}),e.startsAt&&(0,r.jsxs)("p",{children:["• Desde: ",new Date(e.startsAt).toLocaleDateString("es-PE")]}),e.endsAt&&(0,r.jsxs)("p",{children:["• Hasta: ",new Date(e.endsAt).toLocaleDateString("es-PE")]})]})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("button",{onClick:()=>W(e.id,e.active),className:"p-2 rounded ".concat(e.active?"text-yellow-600 hover:bg-yellow-50":"text-green-600 hover:bg-green-50"),children:e.active?(0,r.jsx)(n,{className:"w-5 h-5"}):(0,r.jsx)(i.A,{className:"w-5 h-5"})}),(0,r.jsx)("button",{onClick:()=>L(e.id),className:"p-2 text-red-600 hover:bg-red-50 rounded",children:(0,r.jsx)(c.A,{className:"w-5 h-5"})})]})]})},e.id)),0===e.length&&(0,r.jsx)("div",{className:"text-center py-12 text-gray-500",children:"No hay promociones configuradas"})]}),h&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,r.jsx)("div",{className:"bg-white rounded-lg max-w-lg w-full max-h-[90vh] overflow-y-auto",children:(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Nueva Promoci\xf3n"}),(0,r.jsxs)("form",{onSubmit:q,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipo de Promoci\xf3n"}),(0,r.jsxs)("select",{value:y,onChange:e=>b(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[(0,r.jsx)("option",{value:"TWO_FOR_ONE",children:"2x1"}),(0,r.jsx)("option",{value:"PACK_PRICE",children:"Precio por Pack"}),(0,r.jsx)("option",{value:"HAPPY_HOUR",children:"Happy Hour"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre"}),(0,r.jsx)("input",{type:"text",value:j,onChange:e=>v(e.target.value),required:!0,placeholder:"Ej: Promo Navidad",className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Producto (opcional - dejar vac\xedo para todos)"}),(0,r.jsxs)("select",{value:N,onChange:e=>f(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[(0,r.jsx)("option",{value:"",children:"Todos los productos"}),a.map(e=>(0,r.jsxs)("option",{value:e.id,children:[e.name," ",e.content&&"- ".concat(e.content)]},e.id))]})]}),("TWO_FOR_ONE"===y||"PACK_PRICE"===y)&&(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cantidad M\xednima"}),(0,r.jsx)("input",{type:"number",value:P,onChange:e=>w(e.target.value),min:"2",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),"PACK_PRICE"===y&&(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Precio del Pack (S/)"}),(0,r.jsx)("input",{type:"number",step:"0.01",value:C,onChange:e=>k(e.target.value),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),"HAPPY_HOUR"===y&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Hora Inicio"}),(0,r.jsx)("input",{type:"time",value:E,onChange:e=>S(e.target.value),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Hora Fin"}),(0,r.jsx)("input",{type:"time",value:A,onChange:e=>O(e.target.value),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Precio Happy Hour (S/)"}),(0,r.jsx)("input",{type:"number",step:"0.01",value:_,onChange:e=>R(e.target.value),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]})]}),(0,r.jsxs)("div",{className:"border-t pt-4",children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Vigencia (Opcional)"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs text-gray-600 mb-1",children:"Desde"}),(0,r.jsx)("input",{type:"datetime-local",value:H,onChange:e=>T(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs text-gray-600 mb-1",children:"Hasta"}),(0,r.jsx)("input",{type:"datetime-local",value:F,onChange:e=>I(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"})]})]})]}),(0,r.jsxs)("div",{className:"flex gap-2 pt-4",children:[(0,r.jsx)("button",{type:"button",onClick:()=>{g(!1),K()},className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancelar"}),(0,r.jsx)("button",{type:"submit",className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Crear"})]})]})]})})})]})]})}},3666:(e,t,a)=>{"use strict";function r(e){if(null==e||isNaN(e))return"S/ 0.00";let t="string"==typeof e?parseFloat(e):e;return"S/ ".concat(t.toFixed(2))}a.d(t,{up:()=>r})}},e=>{var t=t=>e(e.s=t);e.O(0,[814,8173,9121,9445,8441,1517,7358],()=>t(5042)),_N_E=e.O()}]);