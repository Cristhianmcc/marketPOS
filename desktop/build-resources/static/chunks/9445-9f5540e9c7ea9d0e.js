"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9445],{9445:(e,r,t)=>{t.d(r,{A:()=>D});var a=t(5155),s=t(2115),n=t(6046),o=t(8173),l=t.n(o),i=t(8474),d=t(4807),c=t(4081),x=t(739),m=t(719),h=t(9136),g=t(9486),u=t(5796),b=t(7936),p=t(5471),f=t(1719),k=t(6967),y=t(8236),v=t(5236),j=t(9655),N=t(7725),w=t(2104);function A(){let{resolvedTheme:e,setTheme:r}=(0,j.D)(),t="dark"===e;return(0,a.jsx)("button",{onClick:()=>{r(t?"light":"dark")},className:"p-2 rounded-lg bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",title:t?"Cambiar a modo claro":"Cambiar a modo oscuro","aria-label":t?"Activar modo claro":"Activar modo oscuro",children:t?(0,a.jsx)(N.A,{className:"w-5 h-5 text-yellow-500"}):(0,a.jsx)(w.A,{className:"w-5 h-5 text-gray-600"})})}var C=t(853),E=t(6233),S=t(1556),P=t(767),T=t(5686),U=t(8384);let F=[{keys:["F2"],description:"Buscar producto",icon:C.A},{keys:["Ctrl","K"],description:"Buscar producto (alternativo)",icon:C.A},{keys:["Enter"],description:"Agregar al carrito / Confirmar",icon:i.A},{keys:["F4"],description:"Abrir modal de pago",icon:E.A},{keys:["F8"],description:"Nueva venta (limpiar carrito)",icon:S.A},{keys:["Esc"],description:"Cerrar modal / Cancelar",icon:P.A},{keys:["Del"],description:"Eliminar item seleccionado",icon:T.A},{keys:["F6"],description:"Aplicar descuento",icon:p.A}];function L(e){let{isOpen:r,onClose:t}=e;return((0,s.useEffect)(()=>{let e=e=>{"Escape"===e.key&&r&&t()};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[r,t]),r)?(0,a.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-black/50 dark:bg-black/70",onClick:t}),(0,a.jsxs)("div",{className:"relative bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-md mx-4 overflow-hidden",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200 dark:border-gray-700",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"p-2 bg-green-100 dark:bg-green-900/30 rounded-lg",children:(0,a.jsx)(U.A,{className:"w-5 h-5 text-green-600 dark:text-green-400"})}),(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Atajos de Teclado"})]}),(0,a.jsx)("button",{onClick:t,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors","aria-label":"Cerrar",children:(0,a.jsx)(P.A,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})})]}),(0,a.jsx)("div",{className:"px-6 py-4 max-h-[60vh] overflow-y-auto",children:(0,a.jsx)("div",{className:"space-y-3",children:F.map((e,r)=>{let t=e.icon;return(0,a.jsxs)("div",{className:"flex items-center justify-between py-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(t,{className:"w-4 h-4 text-gray-400 dark:text-gray-500"}),(0,a.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:e.description})]}),(0,a.jsx)("div",{className:"flex items-center gap-1",children:e.keys.map((r,t)=>(0,a.jsxs)("span",{children:[(0,a.jsx)("kbd",{className:"px-2 py-1 text-xs font-mono font-medium text-gray-600 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded shadow-sm",children:r}),t<e.keys.length-1&&(0,a.jsx)("span",{className:"mx-1 text-gray-400 dark:text-gray-500",children:"+"})]},t))})]},r)})})}),(0,a.jsx)("div",{className:"px-6 py-3 bg-gray-50 dark:bg-gray-900/50 border-t border-gray-200 dark:border-gray-700",children:(0,a.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400 text-center",children:["Presiona ",(0,a.jsx)("kbd",{className:"px-1.5 py-0.5 text-xs font-mono bg-gray-200 dark:bg-gray-700 rounded",children:"?"})," para ver estos atajos"]})})]})]}):null}function I(){let[e,r]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{let e=e=>{let t=e.target;"INPUT"!==t.tagName&&"TEXTAREA"!==t.tagName&&("?"===e.key||"F1"===e.key)&&(e.preventDefault(),r(!0))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{onClick:()=>r(!0),className:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",title:"Atajos de teclado (F1)","aria-label":"Ver atajos de teclado",children:(0,a.jsx)(U.A,{className:"w-5 h-5 text-gray-600 dark:text-gray-300"})}),(0,a.jsx)(L,{isOpen:e,onClose:()=>r(!1)})]})}function R(e){var r,t,o,j,N;let{user:w,collapsed:C=!1,onToggle:E}=e,S=(0,n.usePathname)(),P=(0,n.useRouter)(),[T,U]=(0,s.useState)(!1),F=(null==w?void 0:null===(r=w.role)||void 0===r?void 0:r.toUpperCase())==="OWNER",L=[{icon:i.A,label:"Punto de Venta",href:"/"},{icon:d.A,label:"Turnos / Caja",href:"/shifts"},{icon:c.A,label:"Ventas",href:"/sales"},{icon:x.A,label:"Cuentas por Cobrar",href:"/receivables"},{icon:m.A,label:"Inventario",href:"/inventory"},{icon:h.A,label:"Reportes",href:"/reports"}],R=e=>"/"===e?"/"===S:null==S?void 0:S.startsWith(e),D=async()=>{await fetch("/api/auth/logout",{method:"POST"}),P.push("/login")};return(0,a.jsxs)("aside",{className:"\n      flex flex-col min-h-screen bg-surface-light dark:bg-surface-dark border-r border-border-light dark:border-border-dark\n      transition-all duration-300 ease-in-out flex-shrink-0\n      ".concat(C?"w-16":"w-64","\n    "),children:[(0,a.jsxs)("div",{className:"flex items-center border-b border-border-light dark:border-border-dark h-[73px]",children:[!C&&(0,a.jsxs)("div",{className:"flex items-center gap-3 px-6 py-6 flex-1 min-w-0",children:[(0,a.jsx)("div",{className:"flex items-center justify-center w-10 h-10 rounded-xl bg-primary/10 dark:bg-primary/20 flex-shrink-0",children:(0,a.jsx)(g.A,{className:"w-6 h-6 text-primary"})}),(0,a.jsxs)("div",{className:"min-w-0",children:[(0,a.jsx)("h1",{className:"text-lg font-bold text-text-main dark:text-white",children:"Monterrial"}),(0,a.jsx)("p",{className:"text-xs text-text-secondary dark:text-gray-400",children:"Sistema de ventas"})]})]}),(0,a.jsx)("button",{onClick:E,title:C?"Expandir men\xfa":"Colapsar men\xfa",className:"\n            flex items-center justify-center w-10 h-10 rounded-lg text-text-secondary dark:text-gray-400\n            hover:bg-background-light dark:hover:bg-background-dark hover:text-primary transition-colors flex-shrink-0\n            ".concat(C?"mx-auto":"mr-2","\n          "),children:C?(0,a.jsx)(u.A,{className:"w-5 h-5"}):(0,a.jsx)(b.A,{className:"w-5 h-5"})})]}),w&&!C&&(0,a.jsxs)("div",{className:"flex items-center gap-3 px-6 py-4 border-b border-border-light dark:border-border-dark bg-background-light/50 dark:bg-background-dark/50",children:[(0,a.jsx)("div",{className:"flex items-center justify-center w-10 h-10 rounded-full bg-primary/20 dark:bg-primary/30 text-primary font-semibold flex-shrink-0",children:(null===(t=w.name)||void 0===t?void 0:t.charAt(0).toUpperCase())||"U"}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"text-sm font-semibold text-text-main dark:text-white truncate",children:w.name||"Usuario"}),(0,a.jsx)("p",{className:"text-xs text-text-secondary dark:text-gray-400 truncate",children:(null===(o=w.role)||void 0===o?void 0:o.toUpperCase())==="OWNER"?"Propietario":(null===(j=w.role)||void 0===j?void 0:j.toUpperCase())==="ADMIN"?"Administrador":"Cajero"})]})]}),w&&C&&(0,a.jsx)("div",{className:"flex justify-center py-3 border-b border-border-light dark:border-border-dark",children:(0,a.jsx)("div",{title:w.name||"Usuario",className:"flex items-center justify-center w-9 h-9 rounded-full bg-primary/20 dark:bg-primary/30 text-primary font-semibold text-sm",children:(null===(N=w.name)||void 0===N?void 0:N.charAt(0).toUpperCase())||"U"})}),(0,a.jsxs)("nav",{className:"flex-1 overflow-y-auto px-2 py-4 space-y-1",children:[L.map(e=>{let r=e.icon,t=R(e.href);return(0,a.jsxs)(l(),{href:e.href,title:C?e.label:void 0,className:"\n                flex items-center gap-3 rounded-lg font-medium text-sm transition-all duration-200\n                ".concat(C?"justify-center px-0 py-2.5 mx-1":"px-3 py-2.5","\n                ").concat(t?"bg-primary text-white shadow-sm":"text-text-secondary dark:text-gray-400 hover:bg-background-light dark:hover:bg-background-dark hover:text-text-main dark:hover:text-white","\n              "),children:[(0,a.jsx)(r,{className:"w-5 h-5 flex-shrink-0"}),!C&&(0,a.jsx)("span",{children:e.label})]},e.href)}),F&&(0,a.jsxs)("div",{className:"pt-2",children:[(0,a.jsxs)("button",{onClick:()=>{C&&E?(E(),U(!0)):U(!T)},title:C?"Promociones":void 0,className:"\n                flex items-center rounded-lg font-medium text-sm transition-all duration-200 w-full\n                ".concat(C?"justify-center px-0 py-2.5 mx-1":"justify-between px-3 py-2.5","\n                text-text-secondary dark:text-gray-400 hover:bg-background-light dark:hover:bg-background-dark hover:text-text-main dark:hover:text-white\n              "),children:[(0,a.jsxs)("div",{className:"flex items-center ".concat(C?"":"gap-3"),children:[(0,a.jsx)(p.A,{className:"w-5 h-5 flex-shrink-0"}),!C&&(0,a.jsx)("span",{children:"Promociones"})]}),!C&&(T?(0,a.jsx)(f.A,{className:"w-4 h-4 flex-shrink-0"}):(0,a.jsx)(k.A,{className:"w-4 h-4 flex-shrink-0"}))]}),T&&!C&&(0,a.jsx)("div",{className:"ml-4 mt-1 space-y-1 border-l-2 border-border-light dark:border-border-dark pl-2",children:[{label:"Promociones",href:"/promotions",color:"text-green-600 dark:text-green-400"},{label:"Cupones",href:"/coupons",color:"text-green-600 dark:text-green-400"},{label:"Promos Categor\xeda",href:"/category-promotions",color:"text-purple-600 dark:text-purple-400"},{label:"Promos Pack",href:"/volume-promotions",color:"text-orange-600 dark:text-orange-400"},{label:"Promos N-\xe9simo",href:"/nth-promotions",color:"text-yellow-600 dark:text-yellow-400"}].map(e=>{let r=R(e.href);return(0,a.jsxs)(l(),{href:e.href,className:"\n                        flex items-center gap-2 px-3 py-2 rounded-lg text-sm transition-all duration-200\n                        ".concat(r?"bg-primary/10 dark:bg-primary/20 font-semibold "+e.color:"text-text-secondary dark:text-gray-400 hover:bg-background-light dark:hover:bg-background-dark hover:text-text-main dark:hover:text-white","\n                      "),children:[(0,a.jsx)(p.A,{className:"w-4 h-4 flex-shrink-0"}),(0,a.jsx)("span",{className:"truncate",children:e.label})]},e.href)})})]})]}),(0,a.jsxs)("div",{className:"py-4 space-y-1 border-t border-border-light dark:border-border-dark ".concat(C?"px-2":"px-3"),children:[!C&&(0,a.jsxs)("div",{className:"flex items-center gap-2 px-3 py-2 mb-2",children:[(0,a.jsx)(A,{}),(0,a.jsx)(I,{})]}),C&&(0,a.jsx)("div",{className:"flex flex-col items-center gap-1 mb-2",children:(0,a.jsx)(A,{})}),(0,a.jsxs)(l(),{href:"/settings",title:C?"Configuraci\xf3n":void 0,className:"\n            flex items-center gap-3 rounded-lg font-medium text-sm transition-all duration-200\n            ".concat(C?"justify-center px-0 py-2.5 mx-1":"px-3 py-2.5","\n            ").concat(R("/settings")?"bg-primary text-white shadow-sm":"text-text-secondary dark:text-gray-400 hover:bg-background-light dark:hover:bg-background-dark hover:text-text-main dark:hover:text-white","\n          "),children:[(0,a.jsx)(y.A,{className:"w-5 h-5 flex-shrink-0"}),!C&&(0,a.jsx)("span",{children:"Configuraci\xf3n"})]}),(0,a.jsxs)("button",{onClick:D,title:C?"Cerrar sesi\xf3n":void 0,className:"\n            flex items-center gap-3 rounded-lg font-medium text-sm transition-all duration-200 w-full\n            ".concat(C?"justify-center px-0 py-2.5 mx-1":"px-3 py-2.5","\n            text-text-secondary dark:text-gray-400 hover:bg-red-50 dark:hover:bg-red-950/20 hover:text-red-600 dark:hover:text-red-400\n          "),children:[(0,a.jsx)(v.A,{className:"w-5 h-5 flex-shrink-0"}),!C&&(0,a.jsx)("span",{children:"Cerrar sesi\xf3n"})]})]})]})}function D(e){let{children:r}=e;(0,n.useRouter)();let[t,o]=(0,s.useState)(null),[l,i]=(0,s.useState)(!0),[d,c]=(0,s.useState)(()=>"false"!==localStorage.getItem("sidebarCollapsed"));(0,s.useEffect)(()=>{x()},[]);let x=async()=>{try{let e=await fetch("/api/auth/me");if(e.ok){let r=await e.json();o(r.user)}}catch(e){console.error("Error fetching user:",e)}finally{i(!1)}};return l?(0,a.jsx)("div",{className:"min-h-screen bg-background-light dark:bg-background-dark flex items-center justify-center",children:(0,a.jsxs)("div",{className:"flex flex-col items-center gap-3",children:[(0,a.jsx)("div",{className:"w-12 h-12 border-4 border-primary/30 border-t-primary rounded-full animate-spin"}),(0,a.jsx)("p",{className:"text-text-secondary dark:text-gray-400",children:"Cargando..."})]})}):(0,a.jsxs)("div",{className:"flex h-screen bg-background-light dark:bg-background-dark overflow-hidden",children:[(0,a.jsx)(R,{user:t?{name:t.name,role:t.role.toLowerCase()}:void 0,collapsed:d,onToggle:()=>{c(e=>{let r=!e;return localStorage.setItem("sidebarCollapsed",String(r)),r})}}),(0,a.jsx)("div",{className:"flex-1 flex flex-col overflow-hidden min-w-0",children:(0,a.jsx)("main",{className:"flex-1 overflow-auto",children:r})})]})}},9655:(e,r,t)=>{t.d(r,{D:()=>d,ThemeProvider:()=>i});var a=t(5155),s=t(2115);let n=(0,s.createContext)(void 0),o="bodegapos-theme";function l(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function i(e){let{children:r}=e,[t,i]=(0,s.useState)("light"),[d,c]=(0,s.useState)("light"),[x,m]=(0,s.useState)(!1);return((0,s.useEffect)(()=>{let e=localStorage.getItem(o);e&&["light","dark","system"].includes(e)?i(e):(i("light"),localStorage.setItem(o,"light")),m(!0)},[]),(0,s.useEffect)(()=>{if(!x)return;let e="system"===t?l():t;c(e);let r=document.documentElement;r.classList.remove("light","dark"),r.classList.add(e);let a=document.querySelector('meta[name="theme-color"]');a&&a.setAttribute("content","dark"===e?"#1F2937":"#16A34A")},[t,x]),(0,s.useEffect)(()=>{if(!x||"system"!==t)return;let e=window.matchMedia("(prefers-color-scheme: dark)"),r=()=>{c(l())};return e.addEventListener("change",r),()=>e.removeEventListener("change",r)},[t,x]),x)?(0,a.jsx)(n.Provider,{value:{theme:t,resolvedTheme:d,setTheme:e=>{i(e),localStorage.setItem(o,e)}},children:r}):(0,a.jsx)(a.Fragment,{children:r})}function d(){let e=(0,s.useContext)(n);if(void 0===e)throw Error("useTheme must be used within a ThemeProvider");return e}}}]);